For comparison, here's the reference solution.

xxx
